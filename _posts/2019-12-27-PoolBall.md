---
title : "OpenGL PoolBall Renderer"
date: 2019-12-27
tags: [opengl, libgdx]
header:
   image: "/images/toronto-skyline.jpg"
excerpt: "Uses a phong algorithm implemented in an openGL shader"
---

<script src="soundmanager2-setup.js" id="setup"></script>
<script src="soundmanager2-jsmin.js" id="jsmin"></script>
<div id="embed-html"></div>
<script type="text/javascript" src="/PoolBall/html.nocache.js"></script>

<script>
  function handleMouseDown(evt) {
    evt.preventDefault();
    evt.stopPropagation();
    evt.target.style.cursor = 'default';
    window.focus();
  }

  function handleMouseUp(evt) {
    evt.preventDefault();
    evt.stopPropagation();
    evt.target.style.cursor = '';
  }
  document.getElementById('embed-html').addEventListener('mousedown', handleMouseDown, false);
  document.getElementById('embed-html').addEventListener('mouseup', handleMouseUp, false);
  
  document.getElementsByTagName("table")[0].style="width: 500px; height: 500px;";
</script>

**shader.frag**
~~~
varying LOWP vec4 v_color;
varying vec2 v_texCoords;

varying vec2 v_xy;

uniform sampler2D u_texture;
uniform vec3 u_light;
uniform mat3 u_mat3; //rotation matrix
uniform vec3 u_uv;   //center & length of the texture

void main()
{
    float size = dot(v_xy, v_xy);

    if(size > 1.2) discard;
    else if(size > 1.0) gl_FragColor = vec4(0,0,0,1); //outline
    else {
        vec3 val3 = vec3(v_xy.xy, sqrt(1.0-size));
        float diffuse = dot(val3, u_light);
        val3 *= u_mat3;
        if(val3.z < 0.0)
            val3.x *= -1.0;

        vec2 tex = val3.xy * u_uv.z + u_uv.xy;
        vec4 clr = texture2D(u_texture, tex);
        gl_FragColor = vec4(clr.rgb * (diffuse * .8 + 0.2)
           + pow(diffuse, 16.0) * 0.8 + .02, 1.0);
    }
}
~~~

[Github](https://github.com/vincent-terpstra/pool)
